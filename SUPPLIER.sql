USE NEWDATABASE;
CREATE TABLE SUPPLIER (SID INT,SNAME VARCHAR(30),CITY VARCHAR(20),PRIMARY KEY (SID));
CREATE TABLE PARTS (PID INT ,PNAME VARCHAR(30),COLOR VARCHAR(30) , PRIMARY KEY (PID));
CREATE TABLE CATALOG(SID INT,PID INT ,COST INT ,FOREIGN KEY (SID) REFERENCES SUPPLIER(SID),FOREIGN KEY (PID)REFERENCES PARTS(PID) ); 

INSERT INTO SUPPLIER VALUES(10001,'MANASWI','BLR');
INSERT INTO SUPPLIER VALUES(10002,'ANKITA','MUMBAI');
INSERT INTO SUPPLIER VALUES(10003,'ANVI','NAGPUR');
INSERT INTO SUPPLIER VALUES(10004,'KIRTI','DELHI');
INSERT INTO SUPPLIER VALUES(10005,'MAHAK','PUNE');

INSERT INTO PARTS VALUES(20001,'BOOK','RED');
INSERT INTO PARTS VALUES(20002,'PEN','BLUE');
INSERT INTO PARTS VALUES(20003,'PENCIL','GREEN');
INSERT INTO PARTS VALUES(20004,'SCALE','GREEN');
INSERT INTO PARTS VALUES(20005,'CHARGER','RED');

INSERT INTO CATALOG VALUES(10001,20001,10);
INSERT INTO CATALOG VALUES(10001,20002,10);
INSERT INTO CATALOG VALUES(10002,20003,10);
INSERT INTO CATALOG VALUES(10003,20004,10);
INSERT INTO CATALOG VALUES(10003,20004,10);

SELECT * FROM SUPPLIER;
SELECT * FROM PARTS;
SELECT * FROM CATALOG;

SELECT DISTINCT PNAME FROM PARTS P,SUPPLIER S,CATALOG C WHERE P.PID=C.PID AND C.SID=S.SID;
SELECT SNAME FROM SUPPLIER S WHERE NOT EXISTS(SELECT P.PID FROM PARTS P WHERE NOT EXISTS (SELECT C.PID FROM CATALOG C WHERE C.SID=S.SID AND C.PID=P.PID));

SELECT SNAME FROM SUPPLIER S WHERE NOT EXISTS(SELECT P.PID FROM PARTS P WHERE P.COLOR='RED' AND NOT EXISTS(SELECT * FROM CATALOG C WHERE C.SID=S.SID AND C.PID=P.PID));



SELECT C.SID FROM CATALOG C WHERE C.COST>(SELECT AVG(C2.COST) FROM CATALOG C2 WHERE C2.PID=C.PID);

SELECT P.PNAME FROM PARTS P JOIN CATALOG C ON P.PID=C.PID JOIN SUPPLIER S ON C.SID=S.SID WHERE S.SNAME='MANASWI' AND P.PID NOT IN (SELECT C2.PID FROM CATALOG C2 JOIN SUPPLIER S2 ON C2.SID=S2.SID WHERE S2.SNAME='MANASWI');

SELECT DISTINCT S.SNAME FROM SUPPLIER S,CATALOG C,PARTS P
 WHERE C.SID=S.SID AND P.PID=C.PID AND 
 C.COST=(SELECT MAX(C2.COST) FROM CATALOG C2
 WHERE C2.PID=P.PID);